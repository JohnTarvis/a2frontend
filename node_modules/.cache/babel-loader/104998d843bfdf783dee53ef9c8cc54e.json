{"ast":null,"code":"import _regeneratorRuntime from\"/Users/johnsaville/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/Users/johnsaville/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/johnsaville/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/johnsaville/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/johnsaville/Desktop/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from\"react\";// import React, { useContext } from \"react\";\nimport{useHistory}from\"react-router-dom\";import Alert from\"../common/Alert\";import AnonContext from\"../auth/AnonContext\";function generateRandomTag(){return\"tag\".concat(Math.floor(Math.random()*10),\" \");}function generateRandomTags(){var number=arguments.length>0&&arguments[0]!==undefined?arguments[0]:3;var size=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;var back='';var tags=[];for(var count=0;count<number;count++){var val=Math.floor(Math.random()*size);while(tags.includes(val)){val=Math.floor(Math.random()*size);}tags.push(val);}for(var _count=0;_count<number;_count++){back+=\"Tag\".concat(tags[_count],\" \");}return back;}function NewPostForm(_ref){var createPost=_ref.createPost;var _useContext=useContext(AnonContext),anon=_useContext.anon;var history=useHistory();var _useState=useState({post_subject:\"john\",post_body:\"blah blah blah\",post_tags:generateRandomTags()}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),formErrors=_useState4[0],setFormErrors=_useState4[1];console.debug(\"NewPostForm\",\"createPost=\",typeof createPost,\"formData=\",formData,\"formErrors=\",formErrors);function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(evt){var date,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:evt.preventDefault();date=new Date();formData.post_date=date;_context.next=5;return createPost(formData);case 5:result=_context.sent;if(result.success){history.push(\"/\");}else{setFormErrors(result.errors);}case 7:case\"end\":return _context.stop();}}},_callee);}));return _handleSubmit.apply(this,arguments);}function handleChange(evt){var _evt$target=evt.target,name=_evt$target.name,value=_evt$target.value;setFormData(function(data){return _objectSpread(_objectSpread({},data),{},_defineProperty({},name,value));});}return/*#__PURE__*/React.createElement(\"div\",{className:\"NewPostForm\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container col-md-6 offset-md-3 col-lg-4 offset-lg-4\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"mb-3 text-primary\"},\"New Thread\"),/*#__PURE__*/React.createElement(\"div\",{className:\"card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-body\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Subject\"),/*#__PURE__*/React.createElement(\"input\",{name:\"post_subject\",className:\"form-control\",value:formData.post_subject,onChange:handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Body\"),/*#__PURE__*/React.createElement(\"textarea\",{rows:\"10\",cols:\"10\",name:\"post_body\",className:\"form-control\",value:formData.post_body,onChange:handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Tags\"),/*#__PURE__*/React.createElement(\"input\",{name:\"post_tags\",className:\"form-control\",value:formData.post_tags,onChange:handleChange})),formErrors.length?/*#__PURE__*/React.createElement(Alert,{type:\"danger\",messages:formErrors}):null,/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary float-right\",onSubmit:handleSubmit},\"Submit\"))))));}export default NewPostForm;","map":{"version":3,"sources":["/Users/johnsaville/Desktop/frontend/src/posts/NewPostForm.js"],"names":["React","useState","useContext","useHistory","Alert","AnonContext","generateRandomTag","Math","floor","random","generateRandomTags","number","size","back","tags","count","val","includes","push","NewPostForm","createPost","anon","history","post_subject","post_body","post_tags","formData","setFormData","formErrors","setFormErrors","console","debug","handleSubmit","evt","preventDefault","date","Date","post_date","result","success","errors","handleChange","target","name","value","data","length"],"mappings":"gwBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAAyBC,UAAzB,KAA2C,OAA3C,CACA;AAEA,OAASC,UAAT,KAA2B,kBAA3B,CACA,MAAOC,CAAAA,KAAP,KAAkB,iBAAlB,CAEA,MAAOC,CAAAA,WAAP,KAAwB,qBAAxB,CAEA,QAASC,CAAAA,iBAAT,EAA4B,CAC1B,mBAAaC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,GAAc,EAAzB,CAAb,MACD,CAED,QAASC,CAAAA,kBAAT,EAAgD,IAApBC,CAAAA,MAAoB,2DAAX,CAAW,IAARC,CAAAA,IAAQ,2DAAH,EAAG,CAC9C,GAAIC,CAAAA,IAAI,CAAG,EAAX,CACA,GAAMC,CAAAA,IAAI,CAAG,EAAb,CACA,IAAI,GAAIC,CAAAA,KAAK,CAAG,CAAhB,CAAmBA,KAAK,CAAGJ,MAA3B,CAAmCI,KAAK,EAAxC,CAA2C,CACzC,GAAIC,CAAAA,GAAG,CAAGT,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,GAAcG,IAAzB,CAAV,CACA,MAAME,IAAI,CAACG,QAAL,CAAcD,GAAd,CAAN,CAAyB,CACvBA,GAAG,CAAGT,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,GAAcG,IAAzB,CAAN,CACD,CACDE,IAAI,CAACI,IAAL,CAAUF,GAAV,EACD,CACD,IAAI,GAAID,CAAAA,MAAK,CAAG,CAAhB,CAAmBA,MAAK,CAAGJ,MAA3B,CAAmCI,MAAK,EAAxC,CAA2C,CACzCF,IAAI,eAAUC,IAAI,CAACC,MAAD,CAAd,KAAJ,CACD,CACD,MAAOF,CAAAA,IAAP,CACD,CAED,QAASM,CAAAA,WAAT,MAAqC,IAAdC,CAAAA,UAAc,MAAdA,UAAc,CACnC,gBAAiBlB,UAAU,CAACG,WAAD,CAA3B,CAAQgB,IAAR,aAAQA,IAAR,CACA,GAAMC,CAAAA,OAAO,CAAGnB,UAAU,EAA1B,CACA,cAAgCF,QAAQ,CAAC,CACvCsB,YAAY,CAAE,MADyB,CAEvCC,SAAS,CAAE,gBAF4B,CAGvCC,SAAS,CAAEf,kBAAkB,EAHU,CAAD,CAAxC,wCAAOgB,QAAP,eAAiBC,WAAjB,eAKA,eAAoC1B,QAAQ,CAAC,EAAD,CAA5C,yCAAO2B,UAAP,eAAmBC,aAAnB,eACAC,OAAO,CAACC,KAAR,CACI,aADJ,CAEI,aAFJ,CAEmB,MAAOX,CAAAA,UAF1B,CAGI,WAHJ,CAGiBM,QAHjB,CAII,aAJJ,CAImBE,UAJnB,EATmC,QAepBI,CAAAA,YAfoB,gJAenC,iBAA4BC,GAA5B,kIACEA,GAAG,CAACC,cAAJ,GACMC,IAFR,CAEe,GAAIC,CAAAA,IAAJ,EAFf,CAGEV,QAAQ,CAACW,SAAT,CAAqBF,IAArB,CAHF,sBAIqBf,CAAAA,UAAU,CAACM,QAAD,CAJ/B,QAIMY,MAJN,eAKE,GAAIA,MAAM,CAACC,OAAX,CAAoB,CAClBjB,OAAO,CAACJ,IAAR,CAAa,GAAb,EACD,CAFD,IAEO,CACLW,aAAa,CAACS,MAAM,CAACE,MAAR,CAAb,CACD,CATH,sDAfmC,+CA2BnC,QAASC,CAAAA,YAAT,CAAsBR,GAAtB,CAA2B,CACzB,gBAAwBA,GAAG,CAACS,MAA5B,CAAQC,IAAR,aAAQA,IAAR,CAAcC,KAAd,aAAcA,KAAd,CACAjB,WAAW,CAAC,SAAAkB,IAAI,wCAAUA,IAAV,wBAAiBF,IAAjB,CAAwBC,KAAxB,IAAL,CAAX,CACD,CAED,mBACI,2BAAK,SAAS,CAAC,aAAf,eACE,2BAAK,SAAS,CAAC,qDAAf,eACE,0BAAI,SAAS,CAAC,mBAAd,eADF,cAEE,2BAAK,SAAS,CAAC,MAAf,eACE,2BAAK,SAAS,CAAC,WAAf,eACE,4BAAM,QAAQ,CAAEZ,YAAhB,eACE,2BAAK,SAAS,CAAC,YAAf,eACE,2CADF,cAEE,6BACI,IAAI,CAAC,cADT,CAEI,SAAS,CAAC,cAFd,CAGI,KAAK,CAAEN,QAAQ,CAACH,YAHpB,CAII,QAAQ,CAAEkB,YAJd,EAFF,CADF,cAUE,2BAAK,SAAS,CAAC,YAAf,eACE,wCADF,cAEE,gCAAU,IAAI,CAAC,IAAf,CAAoB,IAAI,CAAC,IAAzB,CACI,IAAI,CAAC,WADT,CAEI,SAAS,CAAC,cAFd,CAGI,KAAK,CAAEf,QAAQ,CAACF,SAHpB,CAII,QAAQ,CAAEiB,YAJd,EAFF,CAVF,cAmBE,2BAAK,SAAS,CAAC,YAAf,eACE,wCADF,cAEE,6BACI,IAAI,CAAC,WADT,CAEI,SAAS,CAAC,cAFd,CAGI,KAAK,CAAEf,QAAQ,CAACD,SAHpB,CAII,QAAQ,CAAEgB,YAJd,EAFF,CAnBF,CA6BGb,UAAU,CAACkB,MAAX,cACK,oBAAC,KAAD,EAAO,IAAI,CAAC,QAAZ,CAAqB,QAAQ,CAAElB,UAA/B,EADL,CAEK,IA/BR,cAkCE,8BACI,IAAI,CAAC,QADT,CAEI,SAAS,CAAC,6BAFd,CAGI,QAAQ,CAAEI,YAHd,WAlCF,CADF,CADF,CAFF,CADF,CADJ,CAqDD,CAED,cAAeb,CAAAA,WAAf","sourcesContent":["import React, { useState,useContext } from \"react\";\n// import React, { useContext } from \"react\";\n\nimport { useHistory } from \"react-router-dom\";\nimport Alert from \"../common/Alert\";\n\nimport AnonContext from \"../auth/AnonContext\";\n\nfunction generateRandomTag(){\n  return `tag${Math.floor(Math.random()*10)} `;\n}\n\nfunction generateRandomTags(number = 3, size=10){\n  let back = '';\n  const tags = [];\n  for(let count = 0; count < number; count++){\n    let val = Math.floor(Math.random()*size);\n    while(tags.includes(val)){\n      val = Math.floor(Math.random()*size);\n    }\n    tags.push(val);\n  }\n  for(let count = 0; count < number; count++){\n    back += `Tag${tags[count]} `;\n  }\n  return back;\n}\n\nfunction NewPostForm({ createPost }) {\n  const { anon } = useContext(AnonContext);\n  const history = useHistory();\n  const [formData, setFormData] = useState({\n    post_subject: \"john\",\n    post_body: \"blah blah blah\",\n    post_tags: generateRandomTags()\n  });\n  const [formErrors, setFormErrors] = useState([]);\n  console.debug(\n      \"NewPostForm\",\n      \"createPost=\", typeof createPost,\n      \"formData=\", formData,\n      \"formErrors=\", formErrors,\n  );\n  async function handleSubmit(evt) {\n    evt.preventDefault();\n    const date = new Date();\n    formData.post_date = date;\n    let result = await createPost(formData);\n    if (result.success) {\n      history.push(\"/\");\n    } else {\n      setFormErrors(result.errors);\n    }\n  }\n\n  function handleChange(evt) {\n    const { name, value } = evt.target;\n    setFormData(data => ({ ...data, [name]: value }));\n  }\n\n  return (\n      <div className=\"NewPostForm\">\n        <div className=\"container col-md-6 offset-md-3 col-lg-4 offset-lg-4\">\n          <h2 className=\"mb-3 text-primary\">New Thread</h2>\n          <div className=\"card\">\n            <div className=\"card-body\">\n              <form onSubmit={handleSubmit}>\n                <div className=\"form-group\">\n                  <label>Subject</label>\n                  <input\n                      name=\"post_subject\"\n                      className=\"form-control\"\n                      value={formData.post_subject}\n                      onChange={handleChange}\n                  />\n                </div>\n                <div className=\"form-group\">\n                  <label>Body</label>\n                  <textarea rows=\"10\" cols=\"10\" \n                      name=\"post_body\"\n                      className=\"form-control\"\n                      value={formData.post_body}\n                      onChange={handleChange}\n                  />\n                </div>\n                <div className=\"form-group\">\n                  <label>Tags</label>\n                  <input\n                      name=\"post_tags\"\n                      className=\"form-control\"\n                      value={formData.post_tags}\n                      onChange={handleChange}\n                  />\n                </div>\n\n                {formErrors.length\n                    ? <Alert type=\"danger\" messages={formErrors} />\n                    : null\n                }\n\n                <button\n                    type=\"submit\"\n                    className=\"btn btn-primary float-right\"\n                    onSubmit={handleSubmit}\n                >\n                  Submit\n                </button>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n  );\n}\n\nexport default NewPostForm;"]},"metadata":{},"sourceType":"module"}